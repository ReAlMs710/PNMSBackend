<button onclick="signup()">up</button>
<button onclick="signin()">in</button>
<input id="textbox" type="text">
<button onclick="yap(document.getElementById('textbox').value)">send</button>

<script>
function signup() {
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.open( "POST", "/makeaccount", false );
	xmlHttp.setRequestHeader('Content-Type', 'application/json');
	xmlHttp.send( '{"username":"stratton","password":"hello","email":"stratjel@gmail.com"}' );
	if (xmlHttp.responseText != "ok") {
		alert("already taken ._.")
	}
}

function signin() {
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.open( "POST", "/startsession", false );
	xmlHttp.setRequestHeader('Content-Type', 'application/json');
	xmlHttp.send( '{"username":"stratton","password":"hello"}' );
	if (xmlHttp.responseText == "badpass") {
		alert("wrong pass (⌐_⌐)");
	}
	alert(xmlHttp.responseText);
	document.cookie = "session=" + xmlHttp.responseText;
}

function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
}

function yap(text) {
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.open( "POST", "/api", false );
	xmlHttp.setRequestHeader('Content-Type', 'application/json');
	xmlHttp.send( '{"session":"' + getCookie("session") + '","text":"' + text + '"}' );
	alert(xmlHttp.responseText);
}
</script>
